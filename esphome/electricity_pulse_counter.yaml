substitutions:
  device_name_upper: "Electricity Pulse Counter"
  device_name_lower: "electricity_pulse_counter"

esphome:
  name: electricity-pulse-counter
  platform: ESP32
  board: esp32doit-devkit-v1

<<: !include common.yaml

# https://esphome.io/components/sensor/pulse_counter.html
sensor:
  - platform: pulse_counter
    id: ${device_name_lower}_current_power
    name: "${device_name_upper} Current Power"
    # internal pull-up 45k
    pin: 33
    unit_of_measurement: "W"
    update_interval: 60s
    accuracy_decimals: 0
    filters:
      - multiply: 60
  - platform: internal_temperature
    id: ${device_name_lower}_device_temperature
    name: "${device_name_upper} Device Temperature"

switch:
  - platform: restart
    id: ${device_name_lower}_restart
    name: "${device_name_upper} Restart"
