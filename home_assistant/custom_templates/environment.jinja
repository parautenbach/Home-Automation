{# https://www.home-assistant.io/docs/configuration/templating/#reusing-templates #}

{# Mapping pollen colours to levels (for the scraper sensors). #}
{% set color_level_map = {
                           "pollen-green": 1,
                           "pollen-yellow": 2,
                           "pollen-lightorange": 3,
                           "pollen-darkorange": 4,
                           "pollen-red": 5
                          } %}

{# Mapping pollen colours to labels (for the scraper sensors). #}
{% set color_label_map = {
                            "pollen-green": "Very Low",
                            "pollen-yellow": "Low",
                            "pollen-lightorange": "Moderate",
                            "pollen-darkorange": "High",
                            "pollen-red": "Very High"
                          } %}

{#
Get the named direction from the bearing in degrees.

:param bearing: The bearing in degrees.
:param flip: Flip bearing in degrees if the direction must be named according to destination and not origin.

:returns: A named direction, e.g. N for north.
#}
{% macro get_direction_8(bearing, flip=false) -%}
  {% if flip %}
    {% set bearing = (bearing + 180) % 360 %}
  {% endif %}
  {% set directions = ['N','NE','E','SE','S','SW','W','NW'] %}
  {{ directions[((bearing + 22.5) // 45) | int % 8] }}
{%- endmacro %}

{#
Get the directional arrow icon from the bearing in degrees.

:param bearing: The bearing in degrees.

:returns: An MDI icon according to the from direction (N will be an up arrow).
#}
{% macro get_icon_direction_8(bearing) -%}
  {% set icons = [
                   'mdi:arrow-up',
                   'mdi:arrow-top-right',
                   'mdi:arrow-right',
                   'mdi:arrow-bottom-right',
                   'mdi:arrow-down',
                   'mdi:arrow-bottom-left',
                   'mdi:arrow-left',
                   'mdi:arrow-top-left'
                 ] %}
  {{ icons[((bearing + 180 + 22.5) // 45) | int % 8] }}
{%- endmacro %}
